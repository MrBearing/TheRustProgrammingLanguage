# スタック領域とヒープ領域についての覚書

## なぜ書いた

Rustの勉強を進めていく上で、スタック領域とヒープ領域へのデータのアロケーションの話題が出た。
Rustで効率的なプログラムを構成するためには、
メモリー上にどのようにデータを配置するかを念頭においた上で、プログラムを構成することが必要となる。
今一度、理解が曖昧な部分を再度調査し、
プログラムが機械語で実行された際のメモリの確保方法を理解するためにこの文章を記述する。

## 対象

以下を対象とする

- アセンブラ動作をある程度理解している.CALL,JUMPの存在等
- 素朴な計算機の仕組みを理解している(演算装置や主記憶装置等いわゆるノイマンコンピュータについて)
- c/c++のポインターをなんとなく理解している。メモリにはアドレスがあり、アドレスを操作することが可能であること等
- メモリにはスタック・ヒープとヒープが存在していることを知っている
  
## なぜ、メモリ空間を確保する必要があるか

おそらくこの手の話題において最大の疑問は
「なぜ、プログラムごとにメモリ空間を作る必要があるのか？」ということだろう。
アドレスを決めて適当に書き込みすれば、メモリのデータはとりあえずは保管できるのだから特に気にする必要などない。
実際、C言語でプログラムを記述する際にメモリの場所を直接記述することはある。(例えば組込のIO等)

では、なぜか。なぜメモリ空間を確保する必要があるのだろうか。
答えは我々が普段使用してるパソコン上においては、OS上で複数のプロセスが動作しているからである。

複数のプロセスが動作しているということは、
当然、CPUでどのプロセスの演算を行うかの順序やメモリのアドレスのどこからどこまでをプロセスに割り当てるかを管理しなければならない。

これが管理されていない場合、別のプロセスが使用中のメモリに上書きしてしまったり、
CPUの演算が割り当てられず特定のプロセスの処理が進まないなどの問題が発生する。

## メモリ空間

では、OSより渡されたメモリ空間はどのような空間の構成で作られているのだろうか。

## ヒープとスタック

## 参考
 - https://www.ipa.go.jp/security/awareness/vendor/programmingv2/contents/c006.html


